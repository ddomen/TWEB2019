<?php
  $this->headScript()->appendFile($this->baseUrl('js/catalogo.js'));
  $cars = array();
  foreach($this->catalog as $car){ array_push($cars, $car->toArray()); }
  $cars = json_encode($cars);

  $this->headScript()->captureStart();
  echo "window.CARS = " . $cars . ";";
  $this->headScript()->captureEnd();
?>
<h1 style='text-align: center'><b>CATALOGO</b></h1>
<br>
<h3>Filtro Catalogo:</h3>
<div><?php echo $this->catalogForm ?></div>
<br>


<?php if($this->layout == 'staff' || $this->layout == 'admin') {?>
<p>
  <button class="btn btn-success" style="font-size: 2em" onclick="window.location.href = '<?=$this->url(array('controller' => 'staff', 'action' => 'newmacchina'),'default',true);?>'">
  AGGIUNGI
  </button>
</p>
<?php } ?>

<?php foreach($this->catalog as $car){ ?>

<div class="panel panel-default">
    <div class="panel-heading panel-primary"><h3><b><?=$car->Marca?> - <?=$car->Modello?></h3></b></div>
    <div class="panel-body">
    
        <div class="row">
        <div class="col-xs-6 col-sm-3"><?=$this->productImg($car->Foto, array('class' => 'img-responsive')) ?></div>
        <div class="col-xs-18 col-sm-9">
            <p style="float:left;">
              <input type="hidden" name="car" value="<?=$car->ID?>" />

              <?php if($this->layout == 'staff' || $this->layout == 'admin'){ ?>
              <p><button class="btn btn-primary" style="font-size: 2em" onclick="window.location.href = '<?=$this->url(array('controller' => $this->layout,
                                     'action' => 'editmacchina',
                                     'id' => $car->ID),'default',true);?>'">MODIFICA</button></p>
              <br>             
              <p>
                <button class="btn btn-danger" style="font-size: 2em" onclick="if(window.confirm('Sicuro di voler eliminare l\'auto <?=$car->Marca?> - <?=$car->Modello?> - <?=$car->TARGA?>?')){
                  window.location.href = '<?=$this->url(array('controller' => $this->layout,'action' => 'deletemacchina','id' => $car->ID),'default',true);?>'
                  }">ELIMINA</button>
              </p>
              <?php } else if($this->layout == 'user'){ ?>
                <p><button class="btn btn-primary noleggia" style="font-size: 2em">NOLEGGIA</button></p>
              <?php } ?>
              
            </p>
            <p><b><?=$this->productPrice($car) ?></b></p>
            <br>
            <p style="clear:left"><b>Posti: </b><?=$car->Posti?></p>
            <p><b>Allestimento: </b><?=$car->Allestimento?></p>
            <p><b>Targa: </b><?=$car->TARGA?></p>
        </div>

        <!-- Add the extra clearfix for only the required viewport -->
        <div class="clearfix visible-xs-block"></div></div>
        
    </div>
</div>

<?php } ?>

<?php if($this->catalog instanceof Zend_Paginator) {
	  	echo $this->paginationControl($this->catalog,'Sliding','public/_paginator.phtml');
	  } 
?>


<div id="noleggio-modal" class="noleggio-modal modal fade" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel">
  <div class="modal-dialog modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header"><h4 class="modal-title">Noleggio Auto</h4></div>
      <div class="modal-body">
        <h3>Targa: <span class="noleggio-modal-targa"></span></h3>
        <h3>Modello: <span class="noleggio-modal-modello"></span></h3>
        <h3>Marca: <span class="noleggio-modal-marca"></span></h3>
        <h3>Prezzo: â‚¬ <span class="noleggio-modal-prezzo"></span></h3>
        <h3>Posti: <span class="noleggio-modal-posti"></span></h3>
        <h3>Allestimento: <span class="noleggio-modal-allestimento"></span></h3>
        <img src="" data-base="<?=$this->baseUrl('images/vetture/')?>" style="max-width: 200px; max-height: 200px;" class="noleggio-modal-foto" />
        <br/>
        <h4 class="message">Seleziona un periodo per noleggiare questa auto</h4>
        <div class="input-group noleggio-date-from">
          <span class="input-group-addon">Data Inizio</span>
          <div class="input-append date" data-date-format="dd-mm-yyyy">
            <input class="span2 bs-datepicker-today form-control" size="16" type="text">
            <span class="add-on"><i class="icon-th"></i></span>
          </div>
        </div>
        <div class="input-group noleggio-date-to">
          <span class="input-group-addon">Data Fine</span>
          <div class="input-append date" data-date-format="dd-mm-yyyy">
            <input class="span2 bs-datepicker-today form-control" size="16" type="text">
            <span class="add-on"><i class="icon-th"></i></span>
          </div>
        </div>
        <br/>
        <button type="button" class="btn btn-info noleggia-check-btn">Controlla Date</button>
        <div class="alert noleggio-modal-risposta" style="font-weight: bolder;"></div>
      </div>
      <br><br>
      <div class="modal-footer">
        <button type="button" class="btn btn-success noleggia-btn" disabled>Noleggia</button>
        <button type="button" class="btn btn-danger" data-dismiss="modal">Annulla</button>
      </div>
    </div>
  </div>
</div>

<?php

?>